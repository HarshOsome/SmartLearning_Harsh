package com.example.EnrollmentMgmt.service;

import org.springframework.stereotype.Service;

import com.example.EnrollmentMgmt.client.CourseClient;
import com.example.EnrollmentMgmt.client.CourseDto;
import com.example.EnrollmentMgmt.resilience.Fallbacks;

import io.github.resilience4j.circuitbreaker.annotation.CircuitBreaker;
import lombok.RequiredArgsConstructor;


@Service
@RequiredArgsConstructor
public class CourseFacade {
    private final CourseClient courseClient;

    @CircuitBreaker(name = "CourseService", fallbackMethod = "getCourseFallback")
    public CourseDto getCourseResilient(Long courseId) {
        return courseClient.getCourse(courseId);
    }

    protected CourseDto getCourseFallback(Long courseId, Throwable ex) {
        return Fallbacks.degradeCourse(courseId, ex); // your 0-hours fallback is fine
    }
}
